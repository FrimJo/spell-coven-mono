<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MTG Card Lookup (Browser CLIP)</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding: 1rem; }
    #queryImg { max-width: 256px; margin-top: 1rem; display:block; }
    #results > div { margin: 0.8rem 0; }
    #spinner { display:none; margin: 0.8rem 0; color:#555; }
    code { background:#f4f4f4; padding:0.15rem 0.35rem; border-radius:4px; }

    /* Webcam UI */
    .camWrap { position: relative; width: 640px; height: 480px; }
    #video, #overlay {
      position: absolute;
      top: 0; left: 0;
      width: 640px; height: 480px;
      border: 1px solid #ccc;
    }
    #overlay { cursor: pointer; z-index: 1; }
    #video { z-index: 0; }
    #cropped { border: 1px solid #ccc; width: 223px; height: 310px; margin-top: 8px; }
    #webcamControls { display:flex; gap: 8px; align-items:center; margin: 8px 0; flex-wrap: wrap; }
  </style>
</head>
<body>
  <h1>MTG Card Lookup</h1>
  <p>Pick a local image (a card or cropped art). The model runs fully in your browser.</p>

  <input type="file" id="fileInput" accept="image/*" disabled />
  <div id="spinner">Loadingâ€¦</div>

  <img id="queryImg" alt="preview" />
  <div id="results"></div>

  <hr>
  <h2>Webcam (prototype)</h2>
  <div id="webcamControls">
    <label for="cameraSelect">Camera:</label>
    <select id="cameraSelect"></select>
    <button id="startCamBtn">Start Webcam</button>
    <button id="searchCroppedBtn" disabled>Search Cropped</button>
    <span id="camStatus" style="color:#666"></span>
  </div>
  <div class="camWrap">
    <video id="video" autoplay muted playsinline width="640" height="480"></video>
    <canvas id="overlay" width="640" height="480"></canvas>
  </div>
  <canvas id="cropped" width="446" height="620"></canvas>
  <canvas id="fullRes" width="640" height="480" style="display:none"></canvas>

  <!-- OpenCV ready bootstrap -->
  <script src="./lib/opencv-loader.js?v=2"></script>
  <script async src="https://docs.opencv.org/4.x/opencv.js" onload="onOpenCvReady()"></script>
  <script type="module" src="./lib/main.js?v=2"></script>
</body>
</html>
